<script>
  //   document.addEventListener("DOMContentLoaded", function(e) {
  //     var eval_table = document.getElementsByClassName("kix-cursor docs-ui-unprintable");
  //     console.log("head;", eval_table);
  //   });


  // function getHtmlContent(){
  //   options = {muteHttpExceptions: true};

  //   var html = UrlFetchApp.fetch('https://docs.google.com/document/d/1kI2BLxrb0oSxyXBqaqBQ8Nb_ArtyMAHb_LlvhdldW_g//mobilebasic', options).getContentText();
  //   console.log("menu", html);
  //   var doc = XmlService.parse(html);
  //   var html = doc.getRootElement();
  //   var menu = getElementsByClassName(html, 'menu-classname')[0];
  //   console.log("menu", html);
  //   return menu;
//}

  function listCollaborators(){
    function onSuccess(editors){
      const div = document.querySelector('.collab_list');

      for(i in Object.entries(editors)){
        const p = document.createElement('p');
        console.log(Object.entries(editors)[i]);


        const color = Object.entries(editors)[i][1]; 
        p.textContent = Object.entries(editors)[i][0];
        p.style.cssText =`color: ${color}`;
        div.append(p);
      }
    }
    
    google.script.run.withSuccessHandler(onSuccess)
      .getAllEditors(); 

  }

  function addButton(){
    const btn = document.querySelector('.adder');
    const contentHeader = document.querySelector('.header')
    
    google.script.run.reportSelection();
    
  }
      
  function updateLockedSections(){
    function onFailure(error) {
      var div = document.getElementById('output');
      div.innerHTML = "ERROR: " + error.message;
    }

    function onSuccess(lockedSections) {
      console.log(lockedSections);
      const output = document.querySelector(".output");
      for (i in lockedSections){
        const div = document.createElement('div');
        const h3 = document.createElement('h3');
        const p1 = document.createElement('p');
        const p2 = document.createElement('p');
        h3.textContent = lockedSections[i][1];
        p1.textContent = lockedSections[i][2];
        p2.textContent = lockedSections[i][3];
        div.append(h3);
        div.append(p1);
        div.append(p2);
        output.append(div);

      }
    }
    google.script.run.withFailureHandler(onFailure)
      .getAllLockedSections();
    google.script.run.withSuccessHandler(onSuccess)
      .getAllLockedSections();
  }

  // function getElementsByClassName(className) {
  //   var body = DocumentApp.getActiveDocument().getBody();
  //   var elements = body.getElementsByClassName(className);
  //   return elements;
  // }

  // function getCollabCursors(){
  //   var doc_pages = document.getElementsByClassName("kix-page-paginated");
  //   console.log(doc_pages);
  //   function onSuccess(doc){
  //     console.log(doc);
  //     var html = XmlService.parse(doc);
  //     var collaborator_cursors = html.getElementsByClassName("kix-cursor docs-ui-unprintable");
  //     console.log("collab cursors: ", collaborator_cursors);
  //   }
  //   google.script.run.withSuccessHandler(onSuccess)
  //     .getHtmlContent(); 

  //   // var collaborator_cursors = getElementsByClassName("kix-cursor docs-ui-unprintable");
  //   // console.log("collab cursors: ", collaborator_cursors);
  //   // for (var i = 0; i < collaborator_cursors.length; i++) {
  //   //   var cursor_name = collaborator_cursors[i].getElementsByClassName("kix-cursor-name")[0].innerText;
  //   //   console.log(cursor_name);
  //   //   if (cursor_name === ""){
  //   //     cursor_name = "Self";
  //   //   }
  //   //   var element = findCursorElement($(collaborator_cursors[i]).offset().top);
  //   // }
  //   //      let onlineCollabs = document.querySelectorAll(".docs-presence-plus-collab-widget-container.goog-inline-block.docs-presence-plus-collab-widget-focus");
  //   //   console.log("onlineCollabs:", onlineCollabs);
  // }

</script>